"use strict";app.resources.objects={onEdit:function(t){var e=t.target.parentNode.getAttribute("data-id")?t.target.parentNode.getAttribute("data-id"):t.target.getAttribute("data-id");if(e){var a=t.target.parentNode.parentNode.parentNode.parentNode,i={type:a.querySelector("select[name='Type']").value,name:a.querySelector("input[name='Name']").value,description:a.querySelector("textarea[name='Description']").value,position:null!==a.querySelector("input[name='Position']")?a.querySelector("input[name='Position']").value:"",longitude:null!==a.querySelector("input[name='Longitude']")?a.querySelector("input[name='Longitude']").value:"",latitude:null!==a.querySelector("input[name='Latitude']")?a.querySelector("input[name='Latitude']").value:"",ipv4:null!==a.querySelector("input[name='IPv4']")?a.querySelector("input[name='IPv4']").value:"",ipv6:null!==a.querySelector("input[name='IPv6']")?a.querySelector("input[name='IPv6']").value:"",secret_key_crypt:null!==a.querySelector("input[id='secret_key_crypt']")?a.querySelector("input[id='secret_key_crypt']").value:"",secret_key:null!==a.querySelector("input[id='secret_key']")?a.querySelector("input[id='secret_key']").value:"",isPublic:1==a.querySelector("label.mdl-switch").classList.contains("is-checked")?"true":"false",meta:{revision:a.querySelector("input[name='meta.revision']").value}},l=new Headers;l.append("Authorization","Bearer "+localStorage.getItem("bearer")),l.append("Content-Type","application/json");var s={method:"PUT",headers:l,body:JSON.stringify(i)},o=app.baseUrl+"/"+app.api_version+"/objects/"+e;fetch(o,s).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){app.setSection("objects"),toast("Object has been saved.",{timeout:3e3,type:"done"})})["catch"](function(t){void 0!==dataLayer&&dataLayer.push({eventCategory:"Interaction",eventAction:"Save Object",eventLabel:"Object has not been saved.",eventValue:"0",event:"Error"}),toast("Object has not been saved.",{timeout:3e3,type:"error"})}),t.preventDefault()}else toast("No Object id found!",{timeout:3e3,type:"error"})},onAdd:function(t){var e=t.target.parentNode.parentNode.parentNode.parentNode,a={type:e.querySelector("select[name='Type']").value,name:e.querySelector("input[name='Name']").value,description:e.querySelector("textarea[name='Description']").value,position:null!==e.querySelector("input[name='Position']")?e.querySelector("input[name='Position']").value:"",longitude:null!==e.querySelector("input[name='Longitude']")?e.querySelector("input[name='Longitude']").value:"",latitude:null!==e.querySelector("input[name='Latitude']")?e.querySelector("input[name='Latitude']").value:"",ipv4:null!==e.querySelector("input[name='IPv4']")?e.querySelector("input[name='IPv4']").value:"",ipv6:null!==e.querySelector("input[name='IPv6']")?e.querySelector("input[name='IPv6']").value:"",secret_key:null!==e.querySelector("input[id='secret_key']")?e.querySelector("input[id='secret_key']").value:"",secret_key_crypt:null!==e.querySelector("input[id='secret_key_crypt']")?e.querySelector("input[id='secret_key_crypt']").value:"",isPublic:1==e.querySelector("label.mdl-switch").classList.contains("is-checked")?"true":"false"},i=new Headers;i.append("Authorization","Bearer "+localStorage.getItem("bearer")),i.append("Content-Type","application/json");var l={method:"POST",headers:i,body:JSON.stringify(a)},s=app.baseUrl+"/"+app.api_version+"/objects/";fetch(s,l).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){app.setSection("objects"),toast("Object has been added.",{timeout:3e3,type:"done"})})["catch"](function(t){void 0!==dataLayer&&dataLayer.push({eventCategory:"Interaction",eventAction:"Add Object",eventLabel:"Object has not been added.",eventValue:"0",event:"Error"}),toast("Object has not been added.",{timeout:3e3,type:"error"})}),t.preventDefault()},onDelete:function(t){},display:function(t,e,a,i){window.scrollTo(0,0),i&&displayPublic(t,e,a,i),t instanceof Object&&e?displayAdd(t,e,a,i):history.pushState({section:"object"},window.location.hash.substr(1),"#object?id="+t),app.containers.spinner.removeAttribute("hidden"),app.containers.spinner.classList.remove("hidden");var l=new Headers;l.append("Authorization","Bearer "+localStorage.getItem("bearer")),l.append("Content-Type","application/json");var s={method:"GET",headers:l},o=app.baseUrl+"/"+app.api_version+"/objects/"+t;fetch(o,s).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){for(var e=0;e<t.data.length;e++){var i=t.data[e];document.title=app.sectionsPageTitles.object.replace(/%s/g,i.attributes.name);var l="";if(l='<section class="mdl-grid mdl-cell--12-col" data-id="'+i.id+'">',l+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',l+='		<div class="mdl-list__item">',l+="			<span class='mdl-list__item-primary-content'>",l+='				<i class="material-icons">'+app.icons.objects+"</i>",l+='				<h2 class="mdl-card__title-text">'+i.attributes.name+"</h2>",l+="			</span>",l+="			<span class='mdl-list__item-secondary-action'>",l+="				<button role='button' class='mdl-button mdl-js-button mdl-button--icon right showdescription_button' for='description-"+i.id+"'>",l+="					<i class='material-icons'>expand_more</i>",l+="				</button>",l+="			</span>",l+="		</div>",l+="		<div class='mdl-cell--12-col hidden' id='description-"+i.id+"'>",l+=app.getField(app.icons.objects,"Id",i.id,{type:"text"}),i.attributes.description&&1!=a){var s=app.nl2br(i.attributes.description);l+=app.getField(app.icons.description,"Description",s,{type:"text"})}if(i.attributes.meta.created&&(l+=app.getField(app.icons.date,"Created",moment(i.attributes.meta.created).format(app.date_format),{type:"text"})),i.attributes.meta.updated&&(l+=app.getField(app.icons.date,"Updated",moment(i.attributes.meta.updated).format(app.date_format),{type:"text"})),i.attributes.meta.revision&&(l+=app.getField(app.icons.update,"Revision",i.attributes.meta.revision,{type:"text"})),l+="	</div>",l+="</section>",l+=app.getSubtitle("Parameters"),l+='<section class="mdl-grid mdl-cell--12-col">',l+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',1==a){var s=i.attributes.description;l+=app.getField(null,"meta.revision",i.attributes.meta.revision,{type:"hidden",id:"meta.revision",pattern:app.patterns.meta_revision}),l+=app.getField(app.icons.objects,"Name",i.attributes.name,{type:"text",id:"Name",isEdit:a,pattern:app.patterns.name,error:"Name should be set and more than 3 chars length."}),l+=app.getField(app.icons.description,"Description",s,{type:"textarea",id:"Description",isEdit:a})}if(i.attributes.type){var o=app.types.find(function(t){return t.name==i.attributes.type});o=void 0!==o?o:"",l+=1==a?app.getField(app.icons.type,"Type",o.name,{type:"select",id:"Type",isEdit:a,options:app.types}):app.getField(app.icons.type,"Type",o.value,{type:"select",id:"Type",isEdit:a,options:app.types})}if((i.attributes.ipv4||1==a)&&(l+=app.getField("my_location","IPv4",i.attributes.ipv4,{type:"text",id:"IPv4",isEdit:a,pattern:app.patterns.ipv4,error:"IPv4 should be valid."})),(i.attributes.ipv6||1==a)&&(l+=app.getField("my_location","IPv6",i.attributes.ipv6,{type:"text",id:"IPv6",isEdit:a,pattern:app.patterns.ipv6,error:"IPv6 should be valid."})),l+="	</div>",l+="</section>",l+=app.getSubtitle("Security"),l+='<section class="mdl-grid mdl-cell--12-col">',l+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',(i.attributes.secret_key||1==a)&&(l+=app.getField("verified_user","Secret Key in symmetric signature",void 0!==i.attributes.secret_key?i.attributes.secret_key:"",{type:"text",id:"secret_key",style:"text-transform: none !important;",isEdit:a,pattern:app.patterns.secret_key,error:""}),l+=app.getField("","","When flow require signed payload, you should provide your secret to verify signature.",{type:"text",isEdit:!1})),(i.attributes.secret_key_crypt||1==a)&&(l+=app.getField("vpn_key","Secret Key in symmetric cryptography",void 0!==i.attributes.secret_key_crypt?i.attributes.secret_key_crypt:"",{type:"text",id:"secret_key_crypt",style:"text-transform: none !important;",isEdit:a,pattern:app.patterns.secret_key_crypt,error:""})),"true"==i.attributes.is_public&&0==a?(l+=app.getField("visibility","true"==i.attributes.is_public?"Object is having a public url":"Object is only visible to you",i.attributes.is_public,{type:"switch",id:"Visibility",isEdit:a}),l+=app.getQrcodeImg(app.icons.date,"",i.id,{type:"text",isEdit:a}),app.getQrcode(app.icons.date,"",i.id,{type:"text",isEdit:a})):l+=app.getField("visibility","true"==i.attributes.is_public?"Object is having a public url":"Object is only visible to you",i.attributes.is_public,{type:"switch",id:"Visibility",isEdit:a}),l+="	</div>",l+="</section>",a||void 0!==i.attributes.parameters&&i.attributes.parameters.length>-1){l+=app.getSubtitle("Custom Parameters"),l+='<section class="mdl-grid mdl-cell--12-col">',l+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">';for(var e in i.attributes.parameters)l+=app.getField("note",i.attributes.parameters[e].name,i.attributes.parameters[e].value,{type:"text",id:i.attributes.parameters[e].name,isEdit:a});a&&(l+=app.getField("note",["Name","Value"],["",""],{type:"2inputs",pattern:[app.patterns.customAttributeName,app.patterns.customAttributeValue],error:["Name should not contains any space nor special char.","Value is free."],id:["Name[]","Value[]"],isEdit:!0})),l+="	</div>",l+="</section>"}(a||i.attributes.longitude||i.attributes.latitude||i.attributes.position)&&(l+=app.getSubtitle("Localization"),l+='<section class="mdl-grid mdl-cell--12-col" style="padding-bottom: 50px !important;">',l+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',l+=app.getField("place","Longitude",i.attributes.longitude,{type:"text",id:"Longitude",isEdit:a,pattern:app.patterns.longitude,error:"Longitude should be valid."}),l+=app.getField("place","Latitude",i.attributes.latitude,{type:"text",id:"Latitude",isEdit:a,pattern:app.patterns.latitude,error:"Latitude should be valid."}),l+=app.getField("pin_drop","Position",i.attributes.position,{type:"text",id:"Position",isEdit:a,pattern:app.patterns.position,error:"Should not be longer than 255 chars."}),l+=app.getMap("my_location","osm",i.attributes.longitude,i.attributes.latitude,!1,!1,!1),l+="	</div>",l+="</section>");var n=[app.getUniqueId(),app.getUniqueId(),app.getUniqueId()];if(a?(l+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+i.id+"'>",app.isLtr()&&(l+="	<div class='mdl-layout-spacer'></div>"),l+="	<div class='mdl-cell--1-col-phone pull-left'>",l+="		<button id='"+n[0]+"' class='back-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+i.id+"'>",l+="			<i class='material-icons'>chevron_left</i>",l+="			<label>View</label>",l+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+n[0]+"'>View Object</label>",l+="		</button>",l+="	</div>",l+="	<div class='mdl-cell--1-col-phone pull-right'>",l+="		<button id='"+n[1]+"' class='save-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+i.id+"'>",l+="			<i class='material-icons'>save</i>",l+="			<label>Save</label>",l+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+n[1]+"'>Save changes to Object</label>",l+="		</button>",l+="	</div>",app.isLtr()||(l+="	<div class='mdl-layout-spacer'></div>"),l+="</section>"):(l+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+i.id+"'>",app.isLtr()&&(l+="	<div class='mdl-layout-spacer'></div>"),l+="	<div class='mdl-cell--1-col-phone pull-left'>",l+="		<button id='"+n[0]+"' class='list-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+i.id+"'>",l+="			<i class='material-icons'>chevron_left</i>",l+="			<label>List</label>",l+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+n[0]+"'>List all Objects</label>",l+="		</button>",l+="	</div>",l+="	<div class='mdl-cell--1-col-phone delete-button'>",l+="		<button id='"+n[1]+"' class='delete-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+i.id+"'>",l+="			<i class='material-icons'>delete</i>",l+="			<label>Delete</label>",l+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+n[1]+"'>Delete Object...</label>",l+="		</button>",l+="	</div>",l+="	<div class='mdl-cell--1-col-phone pull-right'>",l+="		<button id='"+n[2]+"' class='edit-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+i.id+"'>",l+="			<i class='material-icons'>edit</i>",l+="			<label>Edit</label>",l+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+n[2]+"'>Edit Object</label>",l+="		</button>",l+="	</div>",app.isLtr()||(l+="	<div class='mdl-layout-spacer'></div>"),l+="</section>"),app.containers.object.querySelector(".page-content").innerHTML=l,componentHandler.upgradeDom(),app.refreshButtonsSelectors(),a){app.buttons.backObject.addEventListener("click",function(t){app.resources.objects.display(i.id,!1,!1,!1)},!1),app.buttons.saveObject.addEventListener("click",function(t){app.resources.objects.onEdit(t)},!1);var d=document.getElementById("switch-Visibility").parentNode;d&&d.addEventListener("change",function(t){var e=t.target.parentElement.querySelector("div.mdl-switch__label");e.innerText=d.classList.contains("is-checked")!==!1?"Object is having a public url":"Object is only visible to you"})}else app.buttons.listObject.addEventListener("click",function(t){app.setSection("objects"),t.preventDefault()},!1),app.buttons.editObject2.addEventListener("click",function(t){app.resources.objects.display(i.id,!0),t.preventDefault()},!1);if(i.attributes.longitude&&i.attributes.latitude){var p=new ol.Feature({geometry:new ol.geom.Point(new ol.proj.transform([i.attributes.longitude,i.attributes.latitude],"EPSG:4326","EPSG:3857")),name:i.attributes.name,position:i.attributes.position}),r=new ol.style.Style({image:new ol.style.Icon({anchor:[12,12],anchorXUnits:"pixels",anchorYUnits:"pixels",opacity:.8,size:[24,24],src:app.baseUrl+"/js/OpenLayers/img/marker.png"})});p.setStyle(r);var c=new ol.source.Vector({});c.addFeature(p);var u=new ol.layer.Vector({source:c}),m=(new ol.Overlay({element:document.getElementById("popup"),stopEvent:!1}),new ol.Map({layers:[new ol.layer.Tile({source:new ol.source.OSM}),u],target:"osm",interactions:[],view:new ol.View({center:ol.proj.fromLonLat([parseFloat(i.attributes.longitude),parseFloat(i.attributes.latitude)]),zoom:18})}));setTimeout(function(){m.updateSize()},1e3)}app.setExpandAction(),app.setSection("object")}})["catch"](function(t){"true"==localStorage.getItem("settings.debug")&&toast("displayObject error occured..."+t,{timeout:3e3,type:"error"})}),app.containers.spinner.setAttribute("hidden",!0)},displayPublic:function(t,e,a,i){window.scrollTo(0,0),history.pushState({section:"object"},window.location.hash.substr(1),"#object?id="+t),app.containers.spinner.removeAttribute("hidden"),app.containers.spinner.classList.remove("hidden");var l=new Headers;l.append("Authorization","Bearer "+localStorage.getItem("bearer")),l.append("Content-Type","application/json");var s={method:"GET",headers:l},o=app.baseUrl+"/"+app.api_version+"/objects/"+t+"/public";fetch(o,s).then(fetchStatusHandler).then(function(t){return t.json()}).then(function(t){for(var e=0;e<t.data.length;e++){var i=t.data[e],l="";if(l='<section class="mdl-grid mdl-cell--12-col" data-id="'+i.id+'">',l+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',l+='		<div class="mdl-list__item">',l+="			<span class='mdl-list__item-primary-content'>",l+='				<i class="material-icons">'+app.icons.objects+"</i>",l+='				<h2 class="mdl-card__title-text">'+i.attributes.name+"</h2>",l+="			</span>",l+="			<span class='mdl-list__item-secondary-action'>",l+="				<button role='button' class='mdl-button mdl-js-button mdl-button--icon right showdescription_button' for='description-"+i.id+"'>",l+="					<i class='material-icons'>expand_more</i>",l+="				</button>",l+="			</span>",l+="		</div>",l+="		<div class='mdl-cell--12-col hidden' id='description-"+i.id+"'>",l+=app.getField(app.icons.objects,"Id",i.id,{type:"input"}),i.attributes.description||1!=a){var s=app.nl2br(i.attributes.description);l+=app.getField(app.icons.description,"Description",s,{type:"text"})}if(i.attributes.meta.created&&(l+=app.getField(app.icons.date,"Created",moment(i.attributes.meta.created).format(app.date_format),{type:"text"})),i.attributes.meta.updated&&(l+=app.getField(app.icons.date,"Updated",moment(i.attributes.meta.updated).format(app.date_format),{type:"text"})),l+="	</div>",l+="</section>",l+=app.getSubtitle("Parameters"),l+='<section class="mdl-grid mdl-cell--12-col">',l+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',(i.attributes.ipv4||1==a)&&(l+=app.getField("my_location","IPv4",i.attributes.ipv4,{type:"text",isEdit:a,pattern:app.patterns.ipv4,error:"IPv4 should be valid."})),(i.attributes.ipv6||1==a)&&(l+=app.getField("my_location","IPv6",i.attributes.ipv6,{type:"text",isEdit:a,pattern:app.patterns.ipv6,error:"IPv6 should be valid."})),l+="	</div>",l+="</section>",i.attributes.parameters&&i.attributes.parameters.length>-1){l+=app.getSubtitle("Custom Parameters"),l+='<section class="mdl-grid mdl-cell--12-col">',l+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">';for(var e in i.attributes.parameters)l+=app.getField("note",i.attributes.parameters[e].name,i.attributes.parameters[e].value,{type:"text"});l+="	</div>",l+="</section>"}if((i.attributes.longitude||i.attributes.latitude||i.attributes.position)&&(l+=app.getSubtitle("Localization"),l+='<section class="mdl-grid mdl-cell--12-col" style="padding-bottom: 50px !important;">',l+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',i.attributes.longitude&&(l+=app.getField("place","Longitude",i.attributes.longitude,{type:"text"})),i.attributes.latitude&&(l+=app.getField("place","Latitude",i.attributes.latitude,{type:"text"})),i.attributes.position&&(l+=app.getField("pin_drop","Position/Localization (should be descriptive)",i.attributes.position,{type:"text"})),i.attributes.longitude&&i.attributes.latitude&&(l+=app.getMap("my_location","osm",i.attributes.longitude,i.attributes.latitude,!1,!1,!1)),l+="	</div>",l+="</section>"),app.containers.object.querySelector(".page-content").innerHTML=l,componentHandler.upgradeDom(),i.attributes.longitude&&i.attributes.latitude){var o=new ol.Feature({geometry:new ol.geom.Point(new ol.proj.transform([i.attributes.longitude,i.attributes.latitude],"EPSG:4326","EPSG:3857")),name:i.attributes.name,position:i.attributes.position}),n=new ol.style.Style({image:new ol.style.Icon({anchor:[12,12],anchorXUnits:"pixels",anchorYUnits:"pixels",opacity:.8,size:[24,24],src:app.baseUrl+"/js/OpenLayers/img/marker.png"})});o.setStyle(n);var d=new ol.source.Vector({});d.addFeature(o);var p=new ol.layer.Vector({source:d}),r=(new ol.Overlay({element:document.getElementById("popup"),stopEvent:!1}),new ol.Map({layers:[new ol.layer.Tile({source:new ol.source.OSM}),p],target:"osm",interactions:[],view:new ol.View({center:ol.proj.fromLonLat([parseFloat(i.attributes.longitude),parseFloat(i.attributes.latitude)]),zoom:18})}));setTimeout(function(){r.updateSize()},1e3)}app.setExpandAction()}})["catch"](function(t){"true"==localStorage.getItem("settings.debug")&&toast("displayObject error occured..."+t,{timeout:3e3,type:"error"})}),app.containers.spinner.setAttribute("hidden",!0)},displayAdd:function(t,e,a,i){history.pushState({section:"object_add"},window.location.hash.substr(1),"#object_add");var l="";t.id=""!==t.id?t.id:app.getUniqueId(),t.attributes.longitude=parseFloat(""!==t.attributes.longitude?t.attributes.longitude:0).toFixed(6),t.attributes.latitude=parseFloat(""!==t.attributes.latitude?t.attributes.latitude:0).toFixed(6),l+=app.getSubtitle("Description"),l+='<section class="mdl-grid mdl-cell--12-col" data-id="'+t.id+'">',l+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',l+=app.getField(app.icons.objects,"Name",t.attributes.name,{type:"text",id:"Name",isEdit:!0,pattern:app.patterns.name,error:"Name should be set and more than 3 chars length."}),l+=app.getField(app.icons.description,"Description",app.nl2br(t.attributes.description),{type:"textarea",id:"Description",isEdit:!0}),l+=app.getField(app.icons.type,"Type",t.attributes.type,{type:"select",id:"Type",options:app.types,isEdit:!0}),l+=app.getField("my_location","IPv4",t.attributes.ipv4,{type:"text",id:"IPv4",isEdit:!0,pattern:app.patterns.ipv4,error:"IPv4 should be valid."}),l+=app.getField("my_location","IPv6",t.attributes.ipv6,{type:"text",id:"IPv6",isEdit:!0,pattern:app.patterns.ipv6,error:"IPv6 should be valid."}),l+="	</div>",l+="</section>",l+=app.getSubtitle("Security"),l+='<section class="mdl-grid mdl-cell--12-col" data-id="'+t.id+'">',l+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',l+=app.getField("verified_user","Secret Key in symmetric signature",void 0!==t.attributes.secret_key?t.attributes.secret_key:"",{type:"text",id:"secret_key",style:"text-transform: none !important;",isEdit:!0,pattern:app.patterns.secret_key,error:""}),l+=app.getField("","","When flow require signed payload, you should provide your secret to verify signature.",{type:"text",isEdit:!1}),l+=app.getField("vpn_key","Secret Key in symmetric cryptography",void 0!==t.attributes.secret_key_crypt?t.attributes.secret_key_crypt:"",{type:"text",id:"secret_key_crypt",style:"text-transform: none !important;",isEdit:!0,pattern:app.patterns.secret_key_crypt,error:""}),l+=app.getField("visibility","Object is only visible to you",t.attributes.is_public,{type:"switch",id:"Visibility",isEdit:!0}),l+="	</div>",l+="</section>",l+=app.getSubtitle("Custom Parameters"),l+='<section class="mdl-grid mdl-cell--12-col">',l+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',l+=app.getField("note",["Name","Value"],["",""],{type:"2inputs",pattern:[app.patterns.customAttributeName,app.patterns.customAttributeValue],error:["Name should not contains any space nor special char.","Value is free."],id:["Name[]","Value[]"],isEdit:!0}),l+="	</div>",l+="</section>",l+=app.getSubtitle("Localization"),l+='<section class="mdl-grid mdl-cell--12-col" style="padding-bottom: 50px !important;">',l+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',l+=app.getField("place","Longitude",t.attributes.longitude,{type:"text",id:"Longitude",isEdit:!0,pattern:app.patterns.longitude,error:"Longitude should be valid."}),l+=app.getField("place","Latitude",t.attributes.latitude,{type:"text",id:"Latitude",isEdit:!0,pattern:app.patterns.latitude,error:"Latitude should be valid."}),l+=app.getField("pin_drop","Position/Localization (should be descriptive)",t.attributes.position,{type:"text",id:"Position",isEdit:!0,pattern:app.patterns.position,error:"Should not be longer than 255 chars."}),l+=app.getMap("my_location","osm",t.attributes.longitude,t.attributes.latitude,!1,!1,!1),l+="	</div>",l+="</section>";var s=[app.getUniqueId(),app.getUniqueId(),app.getUniqueId()];l+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+t.id+"'>",app.isLtr()&&(l+="	<div class='mdl-layout-spacer'></div>"),l+="	<div class='mdl-cell--1-col-phone pull-left'>",l+="		<button id='"+s[0]+"' class='back-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t.id+"'>",l+="			<i class='material-icons'>chevron_left</i>",l+="			<label>List</label>",l+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+s[0]+"'>List all Objects</label>",l+="		</button>",l+="	</div>",l+="	<div class='mdl-cell--1-col-phone pull-right'>",l+="		<button id='"+s[1]+"' class='add-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t.id+"'>",l+="			<i class='material-icons'>edit</i>",l+="			<label>Save</label>",l+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+s[1]+"'>Save new Object</label>",l+="		</button>",l+="	</div>",app.isLtr()||(l+="	<div class='mdl-layout-spacer'></div>"),l+="</section>",app.containers.object_add.querySelector(".page-content").innerHTML=l,componentHandler.upgradeDom(),app.getLocation();var o=new ol.Feature({geometry:new ol.geom.Point(new ol.proj.transform([parseFloat(t.attributes.longitude),parseFloat(t.attributes.latitude)],"EPSG:4326","EPSG:3857")),name:"",position:""}),n=new ol.style.Style({image:new ol.style.Icon({anchor:[12,12],anchorXUnits:"pixels",anchorYUnits:"pixels",opacity:.8,size:[24,24],src:app.baseUrl+"/js/OpenLayers/img/marker.png"})});o.setStyle(n);var d=new ol.source.Vector({});d.addFeature(o);var p=new ol.layer.Vector({source:d}),r=(new ol.Overlay({element:document.getElementById("popup"),stopEvent:!1}),new ol.Map({layers:[new ol.layer.Tile({source:new ol.source.OSM}),p],target:"osm",interactions:ol.interaction.defaults().extend([new ol.interaction.DragRotateAndZoom]),view:new ol.View({center:ol.proj.fromLonLat([parseFloat(t.attributes.longitude),parseFloat(t.attributes.latitude)]),zoom:18})}));setTimeout(function(){r.updateSize()},1e3),app.refreshButtonsSelectors(),app.buttons.addObjectBack.addEventListener("click",function(t){app.setSection("objects"),t.preventDefault()},!1),app.buttons.addObject.addEventListener("click",function(t){app.resources.objects.onAdd(t)},!1);var c=document.getElementById("switch-Visibility").parentNode;c&&c.addEventListener("change",function(t){var e=t.target.parentElement.querySelector("div.mdl-switch__label");e.innerText=c.classList.contains("is-checked")!==!1?"Object is having a public url":"Object is only visible to you"}),app.setExpandAction()},displayItem:function(t){}},app.resources.flows={onEdit:function(t){var e=t.target.parentNode.getAttribute("data-id")?t.target.parentNode.getAttribute("data-id"):t.target.getAttribute("data-id");if(e){var a=t.target.parentNode.parentNode.parentNode.parentNode.parentNode,i={name:a.querySelector("input[name='Name']").value,mqtt_topic:a.querySelector("input[name='MQTT Topic']").value,data_type:a.querySelector("select[name='DataType']").value,unit:a.querySelector("select[name='Unit']").value,require_signed:1==a.querySelector("label.mdl-switch[data-id='switch-edit_require_signed']").classList.contains("is-checked")?"true":"false",require_encrypted:1==a.querySelector("label.mdl-switch[data-id='switch-edit_require_encrypted']").classList.contains("is-checked")?"true":"false",meta:{revision:a.querySelector("input[name='meta.revision']").value}},l=new Headers;l.append("Authorization","Bearer "+localStorage.getItem("bearer")),l.append("Content-Type","application/json");var s={method:"PUT",headers:l,body:JSON.stringify(i)},o=app.baseUrl+"/"+app.api_version+"/flows/"+e;fetch(o,s).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){app.setSection("flows"),toast("Flow has been saved.",{timeout:3e3,type:"done"})})["catch"](function(t){void 0!==dataLayer&&dataLayer.push({eventCategory:"Interaction",eventAction:"Save Flow",eventLabel:"Flow has not been saved.",eventValue:"0",event:"Error"}),toast("Flow has not been saved.",{timeout:3e3,type:"error"})}),t.preventDefault()}else toast("No Flow id found!",{timeout:3e3,type:"error"})},onAdd:function(t){var e=t.target.parentNode.parentNode.parentNode.parentNode,a={name:e.querySelector("input[name='Name']").value,mqtt_topic:e.querySelector("input[name='MQTT Topic']").value,data_type:e.querySelector("select[name='DataType']").value,unit:e.querySelector("select[name='Unit']").value,require_signed:1==e.querySelector("label.mdl-switch[data-id='switch-add_require_signed']").classList.contains("is-checked")?"true":"false",require_encrypted:1==e.querySelector("label.mdl-switch[data-id='switch-add_require_encrypted']").classList.contains("is-checked")?"true":"false"};"true"==localStorage.getItem("settings.debug")&&console.log("DEBUG onAddFlow",JSON.stringify(a));var i=new Headers;i.append("Authorization","Bearer "+localStorage.getItem("bearer")),i.append("Content-Type","application/json");var l={method:"POST",headers:i,body:JSON.stringify(a)},s=app.baseUrl+"/"+app.api_version+"/flows/";fetch(s,l).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){app.setSection("flows"),toast("Flow has been added.",{timeout:3e3,type:"done"})})["catch"](function(t){void 0!==dataLayer&&dataLayer.push({eventCategory:"Interaction",eventAction:"Add Flow",eventLabel:"Flow has not been added.",eventValue:"0",event:"Error"}),toast("Flow has not been added.",{timeout:3e3,type:"error"})}),t.preventDefault()},onDelete:function(t){},display:function(t,e,a,i){history.pushState({section:"flow"},window.location.hash.substr(1),"#flow?id="+t),window.scrollTo(0,0),app.containers.spinner.removeAttribute("hidden"),app.containers.spinner.classList.remove("hidden");var l=new Headers;l.append("Authorization","Bearer "+localStorage.getItem("bearer")),l.append("Content-Type","application/json");var s={method:"GET",headers:l},o=app.baseUrl+"/"+app.api_version+"/flows/"+t;fetch(o,s).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(e){for(var i=0;i<e.data.length;i++){var l=e.data[i];document.title=app.sectionsPageTitles.flow.replace(/%s/g,l.attributes.name),app.containers.flow.querySelector(".page-content").innerHTML="";var o="",n="",d=[app.getUniqueId(),app.getUniqueId(),app.getUniqueId()];if(a)n+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',n+=app.getField(null,"meta.revision",l.attributes.meta.revision,{type:"hidden",id:"meta.revision",pattern:app.patterns.meta_revision}),n+=app.getField(app.icons.flows,"Name",l.attributes.name,{type:"text",id:"Name",isEdit:!0,pattern:app.patterns.name,error:"Name should be set and more than 3 chars length."}),n+=app.getField(app.icons.mqtts,"MQTT Topic",l.attributes.mqtt_topic,{type:"text",id:"MQTTTopic",isEdit:!0}),n+=app.getField(app.icons.units,"Unit",l.attributes.unit,{type:"select",id:"Unit",isEdit:!0,options:app.units}),n+=app.getField(app.icons.datatypes,"DataType",l.attributes.data_type,{type:"select",id:"DataType",isEdit:!0,options:app.datatypes}),n+=app.getField("verified_user",1==l.attributes.require_signed?"Require payload signature secret from Object":"Does not require payload signature secret from Object secret",l.attributes.require_signed,{type:"switch",id:"edit_require_signed",isEdit:!0}),n+=app.getField("vpn_key",1==l.attributes.require_encrypted?"Require payload encryption secret from Object":"Does not require payload encryption secret from Object secret",l.attributes.require_encrypted,{type:"switch",id:"edit_require_encrypted",isEdit:!0}),n+="	</div>",n+="</section>",n+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+t+"'>",app.isLtr()&&(n+="	<div class='mdl-layout-spacer'></div>"),n+="	<div class='mdl-cell--1-col-phone pull-left'>",n+="		<button id='"+d[0]+"' class='back-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t+"'>",n+="			<i class='material-icons'>chevron_left</i>",n+="			<label>View</label>",n+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+d[0]+"'>View Flow</label>",n+="		</button>",n+="	</div>",n+="	<div class='mdl-cell--1-col-phone pull-right'>",n+="		<button id='"+d[1]+"' class='save-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t+"'>",n+="			<i class='material-icons'>save</i>",n+="			<label>Save</label>",n+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+d[1]+"'>Save Flow</label>",n+="		</button>",n+="	</div>",app.isLtr()||(n+="	<div class='mdl-layout-spacer'></div>"),n+="</section>";else{if(n+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',n+='		<div class="mdl-list__item">',n+="			<span class='mdl-list__item-primary-content'>",n+='				<i class="material-icons">'+app.icons.flows+"</i>",n+='				<h2 class="mdl-card__title-text">'+l.attributes.name+"</h2>",n+="			</span>",n+="			<span class='mdl-list__item-secondary-action'>",n+="				<button role='button' class='mdl-button mdl-js-button mdl-button--icon right showdescription_button' for='description-"+t+"'>",
n+="					<i class='material-icons'>expand_more</i>",n+="				</button>",n+="			</span>",n+="		</div>",n+="		<div class='mdl-cell mdl-cell--12-col hidden' id='description-"+t+"'>",n+=app.getField(app.icons.flows,"Id",l.id,{type:"text"}),l.attributes.description&&(n+=app.getField(null,null,app.nl2br(l.attributes.description),{type:"textarea",id:"Description",isEdit:a})),l.attributes.meta.created&&(n+=app.getField(app.icons.date,"Created",moment(l.attributes.meta.created).format(app.date_format),{type:"text"})),l.attributes.meta.updated&&(n+=app.getField(app.icons.date,"Updated",moment(l.attributes.meta.updated).format(app.date_format),{type:"text"})),l.attributes.meta.revision&&(n+=app.getField(app.icons.update,"Revision",l.attributes.meta.revision,{type:"text"})),l.attributes.type&&(n+=app.getField("extension","Type",l.attributes.type,{type:"text",id:"Type",isEdit:a})),l.attributes.mqtt_topic&&(n+=app.getField(app.icons.mqtts,"MQTT Topic",l.attributes.mqtt_topic,{type:"text",id:"MQTTTopic",isEdit:a})),l.attributes.ttl&&(n+=app.getField("schedule","Time To Live (TTL)",l.attributes.ttl,{type:"text",id:"TTL",isEdit:a})),l.attributes.unit){var p=JSON.parse(localStorage.getItem("units")).find(function(t){return t.name==l.attributes.unit});n+=app.getField(app.icons.units,"Unit",p.value,{type:"select",id:"Unit",isEdit:a,options:app.units})}if(l.attributes.data_type){var r=JSON.parse(localStorage.getItem("datatypes")).find(function(t){return t.name==l.attributes.data_type}).value;n+=app.getField(app.icons.datatypes,"DataType",r,{type:"select",id:"DataType",isEdit:a,options:app.datatypes})}n+=app.getField("verified_user",1==l.attributes.require_signed?"Require payload signature secret from Object":"Does not require payload signature secret from Object",{type:"switch",id:"show_require_signed",isEdit:a}),n+=app.getField("vpn_key",1==l.attributes.require_encrypted?"Require payload encryption secret from Object":"Does not require payload encryption secret from Object",{type:"switch",id:"show_require_encrypted",isEdit:a}),n+="	</div>",n+="</div>",n+="<div class='mdl-card mdl-cell mdl-cell--12-col' id='"+l.id+"'>",n+="	<div class='mdl-cell--12-col mdl-card mdl-shadow--2dp'>",n+="		<span class='mdl-list__item mdl-list__item--two-line'>",n+="			<span class='mdl-list__item-primary-content'>",n+="				<span>"+l.attributes.name+" ("+p.value+"/"+r+")</span>",n+="				<span class='mdl-list__item-sub-title' id='flow-graph-time-"+l.id+"'></span>",n+="			</span>",n+="		</span>",n+="		<span class='mdl-list__item' id='flow-graph-"+l.id+"' style='width:100%; height:200px;'>",n+="			<span class='mdl-list__item-sub-title mdl-chip mdl-chip__text'></span>",n+="		</span>";var c={series:{lines:{show:!0,fill:"false",lineWidth:3,steps:!1}},colors:[""!==l.attributes.color?l.attributes.color:"#000000"],points:{show:!0},legend:{show:!0,position:"sw"},grid:{borderWidth:{top:0,right:0,bottom:0,left:0},borderColor:{top:"",right:"",bottom:"",left:""},clickable:!0,hoverable:!0,autoHighlight:!0,mouseActiveRadius:5},xaxis:{mode:"time",autoscale:!0,timeformat:"%d/%m/%Y<br/>%Hh%M"},yaxis:[{autoscale:!0,position:"left"},{autoscale:!0,position:"right"}]},u=app.baseUrl+"/"+app.api_version+"/data/"+l.id+"?limit=100&sort=desc";fetch(u,s).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){o+="	<div class='mdl-cell--12-col mdl-card mdl-shadow--2dp'>",o+="		<div class='mdl-list__item small-padding'>",o+="			<span class='mdl-list__item-primary-content'>",o+="				<i class='material-icons'>"+app.icons.datapoints+"</i>",o+="				Data Points",o+="			</span>",o+="			<span class='mdl-list__item-secondary-action'>",o+="				<button role='button' class='mdl-button mdl-js-button mdl-button--icon right showdescription_button' for='datapoints-"+l.id+"'>",o+="					<i class='material-icons'>expand_more</i>",o+="				</button>",o+="			</span>",o+="		</div>",o+="		<div class='mdl-cell mdl-cell--12-col hidden' id='datapoints-"+l.id+"'>";var e=[t.data.map(function(t){var e;if("geo"==r){var a={longitude:"",latitude:""};[a.longitude,a.latitude]=t.attributes.value.split(";"),e=a.longitude+", "+a.latitude}else e=p.format.replace(/%s/g,t.attributes.value);return o+=app.getField(app.icons.datapoints,moment(t.attributes.timestamp).format(app.date_format),e,{type:"text",isEdit:!1}),[t.attributes.timestamp,t.attributes.value]})];componentHandler.upgradeDom(),$.plot($("#flow-graph-"+l.id),e,c),o+="		</div>",o+="	</div>";var a=document.createElement("div");a.className="mdl-grid mdl-cell--12-col",a.dataset.id="last-datapoints_"+l.id,a.innerHTML=o,app.containers.flow.querySelector(".page-content").appendChild(a),componentHandler.upgradeDom(),app.setExpandAction()})["catch"](function(t){"Error: Not Found"==t?toast("No data found, graph remain empty.",{timeout:3e3,type:"warning"}):"true"==localStorage.getItem("settings.debug")&&toast("displayFlow error out..."+t,{timeout:3e3,type:"error"})}),n+="	</div>",n+="</div>",n+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+l.id+"'>",app.isLtr()&&(n+="	<div class='mdl-layout-spacer'></div>"),n+="	<div class='mdl-cell--1-col-phone pull-left'>",n+="		<button id='"+d[0]+"' class='list-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+l.id+"'>",n+="			<i class='material-icons'>chevron_left</i>",n+="			<label>List</label>",n+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+d[0]+"'>List all Flows</label>",n+="		</button>",n+="	</div>",n+="	<div class='mdl-cell--1-col-phone delete-button'>",n+="		<button id='"+d[1]+"' class='delete-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+l.id+"'>",n+="			<i class='material-icons'>delete</i>",n+="			<label>Delete</label>",n+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+d[1]+"'>Delete Flow...</label>",n+="		</button>",n+="	</div>",n+="	<div class='mdl-cell--1-col-phone pull-right'>",n+="		<button id='"+d[2]+"' class='edit-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+l.id+"'>",n+="			<i class='material-icons'>edit</i>",n+="			<label>Edit</label>",n+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+d[2]+"'>Edit Flow</label>",n+="		</button>",n+="	</div>",app.isLtr()||(n+="	<div class='mdl-layout-spacer'></div>"),n+="</section>"}var m=document.createElement("section");if(m.className="mdl-grid mdl-cell--12-col",m.dataset.id=l.id,m.innerHTML=n,app.containers.flow.querySelector(".page-content").appendChild(m),app.refreshButtonsSelectors(),a){app.buttons.backFlow.addEventListener("click",function(t){app.resources.flows.display(l.id,!1,!1,!1)},!1),app.buttons.saveFlow.addEventListener("click",function(t){app.resources.flows.onEdit(t)},!1);var b=document.getElementById("switch-edit_require_signed").parentNode;b&&b.addEventListener("change",function(t){var e=t.target.parentElement.querySelector("div.mdl-switch__label");e.innerText="false"!==b.classList.contains("is-checked")?"Require payload signature secret from Object":"Does not require payload signature secret from Object"});var v=document.getElementById("switch-edit_require_encrypted").parentNode;v&&v.addEventListener("change",function(t){var e=t.target.parentElement.querySelector("div.mdl-switch__label");e.innerText="false"!==v.classList.contains("is-checked")?"Require payload encryption secret from Object":"Does not require payload encryption secret from Object"})}else app.buttons.listFlow.addEventListener("click",function(t){app.setSection("flows"),t.preventDefault()},!1),app.buttons.editFlow2.addEventListener("click",function(t){app.displayFlow(l.id,!0),t.preventDefault()},!1);componentHandler.upgradeDom(),app.setExpandAction(),app.setSection("flow")}})["catch"](function(t){"true"==localStorage.getItem("settings.debug")&&toast("displayFlow error occured..."+t,{timeout:3e3,type:"error"})}),app.containers.spinner.setAttribute("hidden",!0)},displayPublic:function(t,e,a,i){},displayAdd:function(t,e,a,i){!localStorage.getItem("units");var l=JSON.parse(localStorage.getItem("units"));!localStorage.getItem("datatypes");var s=JSON.parse(localStorage.getItem("datatypes")),o="";o='<section class="mdl-grid mdl-cell--12-col" data-id="'+t.id+'">',o+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',o+=app.getField(app.icons.flows,"Name",t.attributes.name,{type:"text",id:"Name",isEdit:!0,pattern:app.patterns.name,error:"Name should be set and more than 3 chars length."}),o+=app.getField(app.icons.mqtts,"MQTT Topic",t.attributes.mqtt_topic,{type:"text",id:"MQTTTopic",isEdit:!0}),o+=app.getField(app.icons.units,"Unit",t.attributes.unit,{type:"select",id:"Unit",isEdit:!0,id:"Unit",options:l}),o+=app.getField(app.icons.datatypes,"DataType",t.attributes.datatype,{type:"select",id:"DataType",isEdit:!0,id:"DataType",options:s}),o+=app.getField("verified_user",(t.attributes.require_signed!==!1,"Does not require payload signature secret from Object"),t.attributes.require_signed,{type:"switch",id:"add_require_signed",isEdit:!0}),o+=app.getField("vpn_key",(t.attributes.require_encrypted!==!1,"Does not require payload encryption secret from Object"),t.attributes.require_encrypted,{type:"switch",id:"add_require_encrypted",isEdit:!0}),o+="	</div>",o+="</section>";var n=[app.getUniqueId(),app.getUniqueId(),app.getUniqueId()];o+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+t.id+"'>",app.isLtr()&&(o+="	<div class='mdl-layout-spacer'></div>"),o+="	<div class='mdl-cell--1-col-phone pull-left'>",o+="		<button id='"+n[0]+"' class='back-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+object.id+"'>",o+="			<i class='material-icons'>chevron_left</i>",o+="			<label>List</label>",o+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+n[0]+"'>List all Flows</label>",o+="		</button>",o+="	</div>",o+="	<div class='mdl-cell--1-col-phone pull-right'>",o+="		<button id='"+n[1]+"' class='add-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+object.id+"'>",o+="			<i class='material-icons'>edit</i>",o+="			<label>Save</label>",o+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+n[1]+"'>Save new Flow</label>",o+="		</button>",o+="	</div>",app.isLtr()||(o+="	<div class='mdl-layout-spacer'></div>"),o+="</section>",app.containers.flow_add.querySelector(".page-content").innerHTML=o,componentHandler.upgradeDom(),app.refreshButtonsSelectors(),app.buttons.addFlowBack.addEventListener("click",function(t){app.setSection("flows"),t.preventDefault()},!1),app.buttons.addFlow.addEventListener("click",function(t){app.resources.flows.onAdd(t)},!1);var d=document.getElementById("switch-add_require_signed").parentNode;d&&d.addEventListener("change",function(t){var e=t.target.parentElement.querySelector("div.mdl-switch__label");e.innerText=d.classList.contains("is-checked")!==!1?"Require payload signature secret from Object":"Does not require payload signature secret from Object"});var p=document.getElementById("switch-add_require_encrypted").parentNode;p&&p.addEventListener("change",function(t){var e=t.target.parentElement.querySelector("div.mdl-switch__label");e.innerText=p.classList.contains("is-checked")!==!1?"Require payload encryption secret from Object":"Does not require payload encryption secret from Object"}),app.setExpandAction()},displayItem:function(t){}},app.resources.snippets={onEdit:function(t){var e=t.target.parentNode.getAttribute("data-id")?t.target.parentNode.getAttribute("data-id"):t.target.getAttribute("data-id");if(e){var a=t.target.parentNode.parentNode.parentNode.parentNode,i={name:a.querySelector("input[name='Name']").value,type:a.querySelector("select[name='Type']").value,icon:a.querySelector("select[name='Icon']").value,color:a.querySelector("input[name='Color']").value,flows:Array.prototype.map.call(a.querySelectorAll(".mdl-chips .mdl-chip"),function(t){return JSON.parse(localStorage.getItem("flows"))[t.getAttribute("data-id")].id}),meta:{revision:a.querySelector("input[name='meta.revision']").value}},l=new Headers;l.append("Authorization","Bearer "+localStorage.getItem("bearer")),l.append("Content-Type","application/json");var s={method:"PUT",headers:l,body:JSON.stringify(i)},o=app.baseUrl+"/"+app.api_version+"/snippets/"+e;fetch(o,s).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){app.setSection("snippets"),toast("Snippet has been saved.",{timeout:3e3,type:"done"})})["catch"](function(t){void 0!==dataLayer&&dataLayer.push({eventCategory:"Interaction",eventAction:"Save Snippet",eventLabel:"Snippet has not been saved.",eventValue:"0",event:"Error"}),toast("Snippet has not been saved.",{timeout:3e3,type:"error"})}),t.preventDefault()}else toast("No Snippet id found!",{timeout:3e3,type:"error"})},onAdd:function(t){var e=t.target.parentNode.parentNode.parentNode.parentNode,a={name:e.querySelector("input[name='Name']").value,type:e.querySelector("select[name='Type']").value,icon:e.querySelector("select[name='Icon']").value,color:e.querySelector("input[name='Color']").value,flows:Array.prototype.map.call(e.querySelectorAll(".mdl-chips .mdl-chip"),function(t){return JSON.parse(localStorage.getItem("flows"))[t.getAttribute("data-id")].id})};"true"==localStorage.getItem("settings.debug")&&console.log("DEBUG onAddSnippet",JSON.stringify(a));var i=new Headers;i.append("Authorization","Bearer "+localStorage.getItem("bearer")),i.append("Content-Type","application/json");var l={method:"POST",headers:i,body:JSON.stringify(a)},s=app.baseUrl+"/"+app.api_version+"/snippets/";fetch(s,l).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){app.setSection("snippets"),toast("Snippet has been added.",{timeout:3e3,type:"done"})})["catch"](function(t){void 0!==dataLayer&&dataLayer.push({eventCategory:"Interaction",eventAction:"Add Snippet",eventLabel:"Snippet has not been added.",eventValue:"0",event:"Error"}),toast("Snippet has not been added.",{timeout:3e3,type:"error"})}),t.preventDefault()},onDelete:function(t){},display:function(t,e,a,i){history.pushState({section:"snippet"},window.location.hash.substr(1),"#snippet?id="+t),window.scrollTo(0,0),app.containers.spinner.removeAttribute("hidden"),app.containers.spinner.classList.remove("hidden");var l=new Headers;l.append("Authorization","Bearer "+localStorage.getItem("bearer")),l.append("Content-Type","application/json");var s={method:"GET",headers:l},o=app.baseUrl+"/"+app.api_version+"/snippets/"+t;fetch(o,s).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(e){for(var i=0;i<e.data.length;i++){var l=e.data[i];document.title=app.sectionsPageTitles.snippet.replace(/%s/g,l.attributes.name);var s,o=[app.getUniqueId(),app.getUniqueId(),app.getUniqueId()];if(a){if(s='<section class="mdl-grid mdl-cell--12-col" data-id="'+l.id+'">',s+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',s+='		<div class="mdl-list__item">',s+="			<span class='mdl-list__item-primary-content'>",s+='				<i class="material-icons">'+app.icons.snippets+"</i>",s+='				<h2 class="mdl-card__title-text">'+l.attributes.name+"</h2>",s+="			</span>",s+="			<span class='mdl-list__item-secondary-action'>",s+="				<button role='button' class='mdl-button mdl-js-button mdl-button--icon right showdescription_button' for='description-"+l.id+"'>",s+="					<i class='material-icons'>expand_more</i>",s+="				</button>",s+="			</span>",s+="		</div>",s+="		<div class='mdl-cell--12-col hidden' id='description-"+l.id+"'>",s+=app.getField(app.icons.snippets,"Id",l.id,{type:"text"}),l.attributes.meta.created&&(s+=app.getField(app.icons.date,"Created",moment(l.attributes.meta.created).format(app.date_format),{type:"text"})),l.attributes.meta.updated&&(s+=app.getField(app.icons.date,"Updated",moment(l.attributes.meta.updated).format(app.date_format),{type:"text"})),l.attributes.meta.revision&&(s+=app.getField(app.icons.update,"Revision",l.attributes.meta.revision,{type:"text"})),s+="	</div>",s+="</section>",s+='<section class="mdl-grid mdl-cell--12-col" data-id="'+t+'">',s+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',s+=app.getField(null,"meta.revision",l.attributes.meta.revision,{type:"hidden",id:"meta.revision",pattern:app.patterns.meta_revision}),s+=app.getField(app.icons.snippets,"Name",l.attributes.name,{type:"text",id:"Name",isEdit:a,pattern:app.patterns.name,error:"Name should be set and more than 3 chars length."}),s+=app.getField(app.icons.icon,"Icon",l.attributes.icon,{type:"select",id:"Icon",isEdit:a,options:app.types}),s+=app.getField(app.icons.color,"Color",l.attributes.color,{type:"text",id:"Color",isEdit:a}),s+=app.getField("add_circle_outline","Type",l.attributes.type,{type:"select",id:"Type",options:app.snippetsTypes,isEdit:a}),"null"!==localStorage.getItem("flows")){var n=JSON.parse(localStorage.getItem("flows")).map(function(t){return{value:t.name,name:t.id}});s+=app.getField(app.icons.flows,"Flows to add","",{type:"select",id:"flowsChipsSelect",isEdit:!0,options:n})}else s+=app.getField(app.icons.flows,"Flows to add (you should add some flows first)","",{type:"select",id:"flowsChipsSelect",isEdit:!0,options:{}});s+="		<div class='mdl-list__item--three-line small-padding  mdl-card--expand mdl-chips chips-initial input-field' id='flowsChips'>",s+="			<span class='mdl-chips__arrow-down__container mdl-selectfield__arrow-down__container'><span class='mdl-chips__arrow-down'></span></span>",s+="		</div>",s+="	</div>",s+="</section>",s+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+t+"'>",app.isLtr()&&(s+="	<div class='mdl-layout-spacer'></div>"),s+="	<div class='mdl-cell--1-col-phone pull-left'>",s+="		<button id='"+o[0]+"' class='back-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t+"'>",s+="			<i class='material-icons'>chevron_left</i>",s+="			<label>View</label>",s+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+o[0]+"'>View Snippet</label>",s+="		</button>",s+="	</div>",s+="	<div class='mdl-cell--1-col-phone pull-right'>",s+="		<button id='"+o[1]+"' class='save-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t+"'>",s+="			<i class='material-icons'>save</i>",s+="			<label>Save</label>",s+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+o[1]+"'>Save changes to Snippet</label>",s+="		</button>",s+="	</div>",app.isLtr()||(s+="	<div class='mdl-layout-spacer'></div>"),s+="</section>",app.containers.snippet.querySelector(".page-content").innerHTML=s,componentHandler.upgradeDom(),app.setExpandAction(),app.refreshButtonsSelectors(),app.buttons.backSnippet.addEventListener("click",function(t){app.resources.snippets.display(l.id,!1,!1,!1)},!1),app.buttons.saveSnippet.addEventListener("click",function(t){app.resources.snippets.onEdit(t)},!1),document.getElementById("flowsChipsSelect").parentNode.querySelector("div.mdl-selectfield__list-option-box ul").addEventListener("click",function(t){var e=t.target.getAttribute("data-value"),a=t.target.innerText;app.addChipTo("flowsChips",{name:a,id:e,type:"flows"}),t.preventDefault()},!1),l.attributes.flows&&l.attributes.flows.length>-1&&"null"!==localStorage.getItem("flows")&&l.attributes.flows.map(function(t){var e=0,a=JSON.parse(localStorage.getItem("flows")).find(function(a){return a.index=e++,a.id==t});app.addChipTo("flowsChips",{name:a.name,id:a.index,type:"flows"})})}else s='<section class="mdl-grid mdl-cell--12-col" data-id="'+t+'">',s+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',s+='		<div class="mdl-list__item">',s+="			<span class='mdl-list__item-primary-content'>",s+='				<h2 class="mdl-card__title-text">',s+='					<i class="material-icons">'+app.icons.snippets+"</i>",s+="					"+l.attributes.name+"</h2>",s+="			</span>",s+="			<span class='mdl-list__item-secondary-action'>",s+="				<button role='button' class='mdl-button mdl-js-button mdl-button--icon right showdescription_button' for='description-"+t+"'>",s+="					<i class='material-icons'>expand_more</i>",s+="				</button>",s+="			</span>",s+="		</div>",s+="		<div class='mdl-cell mdl-cell--12-col hidden' id='description-"+t+"'>",l.attributes.meta.created&&(s+=app.getField(app.icons.date,"Created",moment(l.attributes.meta.created).format(app.date_format),{type:"text"})),l.attributes.meta.updated&&(s+=app.getField(app.icons.date,"Updated",moment(l.attributes.meta.updated).format(app.date_format),{type:"text"})),l.attributes.meta.revision&&(s+=app.getField(app.icons.update,"Revision",l.attributes.meta.revision,{type:"text"})),s+=app.getField(app.icons.icon,"Icon",l.attributes.icon,{type:"select",id:"Icon",isEdit:a,options:app.types}),s+=app.getField(app.icons.color,"Color",l.attributes.color,{type:"text",id:"Color",isEdit:a}),s+=app.getField("add_circle_outline","Type",l.attributes.type,{type:"select",id:"Type",options:app.snippetsTypes,isEdit:a}),s+=app.getField(app.icons.flows,"Linked Flows #",l.attributes.flows.length,{type:"text"}),s+="	</div>",s+="</section>",s+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+flow.id+"'>",app.isLtr()&&(s+="	<div class='mdl-layout-spacer'></div>"),s+="	<div class='mdl-cell--1-col-phone pull-left'>",s+="		<button id='"+o[0]+"' class='list-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+flow.id+"'>",s+="			<i class='material-icons'>chevron_left</i>",s+="			<label>List</label>",s+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+o[0]+"'>List all Snippets</label>",s+="		</button>",s+="	</div>",s+="	<div class='mdl-cell--1-col-phone delete-button'>",s+="		<button id='"+o[1]+"' class='delete-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+flow.id+"'>",s+="			<i class='material-icons'>delete</i>",s+="			<label>Delete</label>",s+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+o[1]+"'>Delete Snippet</label>",s+="		</button>",s+="	</div>",s+="	<div class='mdl-cell--1-col-phone pull-right'>",s+="		<button id='"+o[2]+"' class='edit-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+flow.id+"'>",s+="			<i class='material-icons'>edit</i>",s+="			<label>Edit</label>",s+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+o[2]+"'>Edit Snippet</label>",s+="		</button>",s+="	</div>",app.isLtr()||(s+="	<div class='mdl-layout-spacer'></div>"),s+="</section>",s+="<section class='mdl-grid mdl-cell--12-col snippetPreview'>",app.getSnippet(app.icons.snippets,l.id,app.containers.snippet.querySelector(".page-content")),s+="</section>",app.containers.snippet.querySelector(".page-content").innerHTML=s,componentHandler.upgradeDom(),app.setExpandAction(),app.refreshButtonsSelectors(),app.buttons.listSnippet.addEventListener("click",function(t){app.setSection("snippets"),t.preventDefault()},!1),app.buttons.editSnippet2.addEventListener("click",function(t){app.displaySnippet(l.id,!0),t.preventDefault()},!1);app.setSection("snippet")}})["catch"](function(t){console.log(t),"true"==localStorage.getItem("settings.debug")&&toast("displaySnippet error occured..."+t,{timeout:3e3,type:"error"})}),app.containers.spinner.setAttribute("hidden",!0)},displayPublic:function(t,e,a,i){},displayAdd:function(t,e,a,i){var l="";if(l="<section class='mdl-grid mdl-cell--12-col' data-id='"+t.id+"'>",l+="	<div class='mdl-cell--12-col mdl-card mdl-shadow--2dp'>",l+=app.getField(app.icons.snippets,"Name",t.attributes.name,{type:"text",id:"Name",isEdit:!0,pattern:app.patterns.name,error:"Name should be set and more than 3 chars length."}),l+=app.getField(app.icons.icon,"Icon",t.attributes.icon,{type:"select",id:"Icon",isEdit:!0,options:app.types}),l+=app.getField(app.icons.color,"Color",t.attributes.color,{type:"text",id:"Color",isEdit:!0}),l+=app.getField("add_circle_outline","Type",t.attributes.type,{type:"select",id:"Type",options:app.snippetsTypes,isEdit:!0}),"null"!=localStorage.getItem("flows")){var s=JSON.parse(localStorage.getItem("flows")).map(function(t){return{value:t.name,name:t.id}});l+=app.getField(app.icons.flows,"Flows to add","",{type:"select",id:"flowsChipsSelect",isEdit:!0,options:s})}else app.getFlows(),l+=app.getField(app.icons.flows,"Flows to add (you should add flow first)","",{type:"select",id:"flowsChipsSelect",isEdit:!0,options:{}});l+="		<div class='mdl-list__item--three-line small-padding  mdl-card--expand mdl-chips chips-initial input-field' id='flowsChips'>",l+="			<span class='mdl-chips__arrow-down__container mdl-selectfield__arrow-down__container'><span class='mdl-chips__arrow-down'></span></span>",l+="		</div>",l+="	</div>",l+="</section>";var o=[app.getUniqueId(),app.getUniqueId(),app.getUniqueId()];l+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+flow.id+"'>",app.isLtr()&&(l+="	<div class='mdl-layout-spacer'></div>"),l+="	<div class='mdl-cell--1-col-phone pull-left'>",l+="		<button id='"+o[0]+"' class='back-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+object.id+"'>",l+="			<i class='material-icons'>chevron_left</i>",l+="			<label>List</label>",l+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+o[0]+"'>List all Snippets</label>",l+="		</button>",l+="	</div>",l+="	<div class='mdl-cell--1-col-phone pull-right'>",l+="		<button id='"+o[1]+"' class='add-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+object.id+"'>",l+="			<i class='material-icons'>edit</i>",l+="			<label>Save</label>",l+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+o[1]+"'>Save new Snippet</label>",l+="		</button>",l+="	</div>",app.isLtr()||(l+="	<div class='mdl-layout-spacer'></div>"),l+="</section>",app.containers.snippet_add.querySelector(".page-content").innerHTML=l,componentHandler.upgradeDom(),document.getElementById("flowsChipsSelect").parentNode.querySelector("div.mdl-selectfield__list-option-box ul").addEventListener("click",function(t){console.log(t.target);var e=t.target.getAttribute("data-value"),a=t.target.innerText;console.log({name:a,id:e,type:"flows"}),app.addChipTo("flowsChips",{name:a,id:e,type:"flows"}),t.preventDefault()},!1),app.refreshButtonsSelectors(),app.buttons.addSnippetBack.addEventListener("click",function(t){app.setSection("snippets"),t.preventDefault()},!1),app.buttons.addSnippet.addEventListener("click",function(t){app.resources.snippets.onAdd(t)},!1),app.setExpandAction()},displayItem:function(t){}},app.resources.dashboards={onEdit:function(t){var e=t.target.parentNode.getAttribute("data-id")?t.target.parentNode.getAttribute("data-id"):t.target.getAttribute("data-id");if(e){var a=t.target.parentNode.parentNode.parentNode.parentNode,i={name:a.querySelector("input[name='Name']").value,description:a.querySelector("textarea[name='Description']").value,snippets:Array.prototype.map.call(a.querySelectorAll(".mdl-chips .mdl-chip"),function(t){return JSON.parse(localStorage.getItem("snippets"))[t.getAttribute("data-id")].id}),meta:{revision:a.querySelector("input[name='meta.revision']").value}};"true"==localStorage.getItem("settings.debug")&&console.log("DEBUG onEditDashboard",JSON.stringify(i));var l=new Headers;l.append("Authorization","Bearer "+localStorage.getItem("bearer")),l.append("Content-Type","application/json");var s={method:"PUT",headers:l,body:JSON.stringify(i)},o=app.baseUrl+"/"+app.api_version+"/dashboards/"+e;fetch(o,s).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){app.setSection("dashboards"),toast("Dashboard has been saved.",{timeout:3e3,type:"done"})})["catch"](function(t){void 0!==dataLayer&&dataLayer.push({eventCategory:"Interaction",eventAction:"Save Dashboard",eventLabel:"Dashboard has not been saved.",eventValue:"0",event:"Error"}),toast("Dashboard has not been saved.",{timeout:3e3,type:"error"})}),t.preventDefault()}else toast("No Dashboard id found!",{timeout:3e3,type:"error"})},onAdd:function(t){var e=t.target.parentNode.parentNode.parentNode.parentNode,a={name:e.querySelector("input[name='Name']").value,description:e.querySelector("textarea[name='Description']").value,snippets:Array.prototype.map.call(e.querySelectorAll(".mdl-chips .mdl-chip"),function(t){return JSON.parse(localStorage.getItem("snippets"))[t.getAttribute("data-id")].id})};"true"==localStorage.getItem("settings.debug")&&console.log("DEBUG onAddDashboard",JSON.stringify(a));var i=new Headers;i.append("Authorization","Bearer "+localStorage.getItem("bearer")),i.append("Content-Type","application/json");var l={method:"POST",headers:i,body:JSON.stringify(a)},s=app.baseUrl+"/"+app.api_version+"/dashboards/";fetch(s,l).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){app.setSection("dashboards"),toast("Dashboard has been added.",{timeout:3e3,type:"done"})})["catch"](function(t){void 0!==dataLayer&&dataLayer.push({eventCategory:"Interaction",eventAction:"Add Dashboard",eventLabel:"Dashboard has not been added.",eventValue:"0",event:"Error"}),toast("Dashboard has not been added.",{timeout:3e3,type:"error"})}),t.preventDefault()},onDelete:function(t){},display:function(t,e,a,i){history.pushState({section:"dashboard"},window.location.hash.substr(1),"#dashboard?id="+t),window.scrollTo(0,0),app.containers.spinner.removeAttribute("hidden"),app.containers.spinner.classList.remove("hidden");var l=new Headers;l.append("Authorization","Bearer "+localStorage.getItem("bearer")),l.append("Content-Type","application/json");var s={method:"GET",headers:l},o=app.baseUrl+"/"+app.api_version+"/dashboards/"+t;fetch(o,s).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(e){for(var i=0;i<e.data.length;i++){var l=e.data[i];document.title=app.sectionsPageTitles.dashboard.replace(/%s/g,l.attributes.name);var s;if(s='<section class="mdl-grid mdl-cell--12-col" data-id="'+t+'">',s+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',s+='		<div class="mdl-list__item">',s+="			<span class='mdl-list__item-primary-content'>",s+='				<h2 class="mdl-card__title-text">'+l.attributes.name+"</h2>",s+="			</span>",s+="			<span class='mdl-list__item-secondary-action'>",s+="				<button role='button' class='mdl-button mdl-js-button mdl-button--icon right showdescription_button' for='description-"+t+"'>",s+="					<i class='material-icons'>expand_more</i>",s+="				</button>",s+="			</span>",s+="		</div>",s+="		<div class='mdl-cell mdl-cell--12-col hidden' id='description-"+t+"'>",l.attributes.description){var o=app.nl2br(l.attributes.description);s+=app.getField(app.icons.description,"Description",o,{type:"text",isEdit:!1})}l.attributes.meta.created&&(s+=app.getField(app.icons.date,"Created",moment(l.attributes.meta.created).format(app.date_format),{type:"text",isEdit:!1})),l.attributes.meta.updated&&(s+=app.getField(app.icons.date,"Updated",moment(l.attributes.meta.updated).format(app.date_format),{type:"text",isEdit:!1})),l.attributes.meta.revision&&(s+=app.getField(app.icons.update,"Revision",l.attributes.meta.revision,{type:"text",isEdit:!1})),s+="		</div>",s+="	</div>",s+="</section>";var n=[app.getUniqueId(),app.getUniqueId(),app.getUniqueId()];if(a){if(s+='<section class="mdl-grid mdl-cell--12-col" data-id="'+t+'">',s+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',s+=app.getField(null,"meta.revision",l.attributes.meta.revision,{type:"hidden",id:"meta.revision",pattern:app.patterns.meta_revision}),s+=app.getField(app.icons.dashboards,"Name",l.attributes.name,{type:"text",id:"Name",isEdit:a,pattern:app.patterns.name,error:"Name should be set and more than 3 chars length."}),s+=app.getField(app.icons.description,"Description",app.nl2br(l.attributes.description),{type:"textarea",id:"Description",isEdit:a}),"null"!=localStorage.getItem("snippets")){var d=JSON.parse(localStorage.getItem("snippets")).map(function(t){return{value:t.name,name:t.id,sType:t.sType}});s+=app.getField(app.icons.snippets,"Snippets to add","",{type:"select",id:"snippetsChipsSelect",isEdit:!0,options:d
})}else app.getSnippets(),s+=app.getField(app.icons.snippets,"Snippets to add (you should add some snippets first)","",{type:"select",id:"snippetsChipsSelect",isEdit:!0,options:{}});s+="		<div class='mdl-list__item--three-line small-padding  mdl-card--expand mdl-chips chips-initial input-field' id='snippetsChips'>",s+="			<span class='mdl-chips__arrow-down__container mdl-selectfield__arrow-down__container'><span class='mdl-chips__arrow-down'></span></span>",s+="		</div>",s+="	</div>",s+="</section>",s+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+t+"'>",app.isLtr()&&(s+="	<div class='mdl-layout-spacer'></div>"),s+="	<div class='mdl-cell--1-col-phone pull-left'>",s+="		<button id='"+n[0]+"' class='back-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t+"'>",s+="			<i class='material-icons'>chevron_left</i>",s+="			<label>View</label>",s+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+n[0]+"'>View Dashboard</label>",s+="		</button>",s+="	</div>",s+="	<div class='mdl-cell--1-col-phone pull-right'>",s+="		<button id='"+n[1]+"' class='save-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t+"'>",s+="			<i class='material-icons'>save</i>",s+="			<label>Save</label>",s+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+n[1]+"'>Save changes to Dashboard</label>",s+="		</button>",s+="	</div>",app.isLtr()||(s+="	<div class='mdl-layout-spacer'></div>"),s+="</section>"}else for(var i=0;i<l.attributes.snippets.length;i++)app.getSnippet(app.icons.snippets,l.attributes.snippets[i],app.containers.dashboard.querySelector(".page-content"));app.containers.dashboard.querySelector(".page-content").innerHTML=s,app.setExpandAction(),componentHandler.upgradeDom(),app.refreshButtonsSelectors(),a&&(app.buttons.backDashboard.addEventListener("click",function(t){app.resources.dashboards.display(l.id,!1,!1,!1)},!1),app.buttons.saveDashboard.addEventListener("click",function(t){app.resources.dashboards.onEdit(t)},!1),document.getElementById("snippetsChipsSelect").parentNode.querySelector("div.mdl-selectfield__list-option-box ul").addEventListener("click",function(t){var e=t.target.getAttribute("data-value"),a=0;if("null"!=localStorage.getItem("snippets"))var i=JSON.parse(localStorage.getItem("snippets")).find(function(t){return a==e?t:void a++});i.sType,t.target.innerText;app.addChipSnippetTo("snippetsChips",{name:i.name,id:e,sType:i.sType,type:"snippets"}),t.preventDefault()},!1),l.attributes.snippets&&l.attributes.snippets.length>-1&&l.attributes.snippets.map(function(t){var e=0;if("null"!=localStorage.getItem("snippets")){var a=JSON.parse(localStorage.getItem("snippets")).find(function(a){return a.index=e++,a.id==t});app.addChipSnippetTo("snippetsChips",{name:a.name,id:a.index,sType:a.sType,type:"snippets"})}})),componentHandler.upgradeDom(),app.setExpandAction();var p=document.querySelectorAll("#snippetsChips .mdl-chip");[].forEach.call(p,app.addDnDHandlers),app.setSection("dashboard")}})["catch"](function(t){"true"==localStorage.getItem("settings.debug")&&toast("displayDashboard error occured..."+t,{timeout:3e3,type:"error"})}),app.containers.spinner.setAttribute("hidden",!0)},displayPublic:function(t,e,a,i){},displayAdd:function(t,e,a,i){var l="";l='<section class="mdl-grid mdl-cell--12-col" data-id="'+t.id+'">',l+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',l+=app.getField(app.icons.dashboards,"Name",t.attributes.name,{type:"text",id:"Name",isEdit:!0,pattern:app.patterns.name,error:"Name should be set and more than 3 chars length."}),l+=app.getField(app.icons.description,"Description",app.nl2br(t.attributes.description),{type:"textarea",id:"Description",isEdit:!0});var s;"null"!=localStorage.getItem("snippets")?s=JSON.parse(localStorage.getItem("snippets")).map(function(t){return{value:t.name,name:t.id,sType:t.sType}}):(app.getSnippets(),toast("You should add a Snippet first, it seems you don' have any yet.",{timeout:3e3,type:"warning"}),s=[{value:"undefined",name:"undefined",sType:"undefined"}]),l+=app.getField(app.icons.snippets,"Snippets to add","",{type:"select",id:"snippetsChipsSelect",isEdit:!0,options:s}),l+="		<div class='mdl-list__item--three-line small-padding  mdl-card--expand mdl-chips chips-initial input-field' id='snippetsChips'>",l+="			<span class='mdl-chips__arrow-down__container mdl-selectfield__arrow-down__container'><span class='mdl-chips__arrow-down'></span></span>",l+="		</div>",l+="	</div>",l+="</section>";var o=[app.getUniqueId(),app.getUniqueId(),app.getUniqueId()];l+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+flow.id+"'>",app.isLtr()&&(l+="	<div class='mdl-layout-spacer'></div>"),l+="	<div class='mdl-cell--1-col-phone pull-left'>",l+="		<button id='"+o[0]+"' class='back-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+object.id+"'>",l+="			<i class='material-icons'>chevron_left</i>",l+="			<label>List</label>",l+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+o[0]+"'>List all Dashboards</label>",l+="		</button>",l+="	</div>",l+="	<div class='mdl-cell--1-col-phone pull-right'>",l+="		<button id='"+o[1]+"' class='add-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+object.id+"'>",l+="			<i class='material-icons'>edit</i>",l+="			<label>Save</label>",l+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+o[1]+"'>Save new Dashboard</label>",l+="		</button>",l+="	</div>",app.isLtr()||(l+="	<div class='mdl-layout-spacer'></div>"),l+="</section>",app.containers.dashboard_add.querySelector(".page-content").innerHTML=l,componentHandler.upgradeDom(),document.getElementById("snippetsChipsSelect").parentNode.querySelector("div.mdl-selectfield__list-option-box ul").addEventListener("click",function(t){var e=t.target.getAttribute("data-value"),a=0,i=JSON.parse(localStorage.getItem("snippets")).find(function(t){return a==e?t:void a++}),l=i.sType,s=t.target.innerText;app.addChipSnippetTo("snippetsChips",{name:s,id:e,sType:l,type:"snippets"}),t.preventDefault()},!1),app.refreshButtonsSelectors(),app.buttons.addDashboardBack.addEventListener("click",function(t){app.setSection("dashboards"),t.preventDefault()},!1),app.buttons.addDashboard.addEventListener("click",function(t){app.resources.dashboards.onAdd(t)},!1),app.setExpandAction()},displayItem:function(t){}},app.resources.rules={onEdit:function(t){},onAdd:function(t){var e=t.target.parentNode.parentNode.parentNode.parentNode,a={name:e.querySelector("input[name='Name']").value,active:e.querySelector("input[id='switch-active']").parentNode.classList.contains("is-checked")?!0:!1,rule:{priority:e.querySelector("input[name='Priority']").value,conditions:JSON.parse(e.querySelector("textarea[name='Event Conditions']").value),event:{type:e.querySelector("select[name='Event Type']").value,params:JSON.parse(e.querySelector("textarea[name='Event Parameters']").value)}}};"true"==localStorage.getItem("settings.debug")&&console.log("DEBUG onAddRule",JSON.stringify(a));var i=new Headers;i.append("Authorization","Bearer "+localStorage.getItem("bearer")),i.append("Content-Type","application/json");var l={method:"POST",headers:i,body:JSON.stringify(a)},s=app.baseUrl+"/"+app.api_version+"/rules/";fetch(s,l).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){app.setSection("rules"),toast("Rule has been added.",{timeout:3e3,type:"done"})})["catch"](function(t){void 0!==dataLayer&&dataLayer.push({eventCategory:"Interaction",eventAction:"Add Rule ",eventLabel:"Rule has not been added.",eventValue:"0",event:"Error"}),toast("Rule has not been added.",{timeout:3e3,type:"error"})}),t.preventDefault()},onDelete:function(t){},display:function(t,e,a,i){history.pushState({section:"rule"},window.location.hash.substr(1),"#rule?id="+t),window.scrollTo(0,0),app.containers.spinner.removeAttribute("hidden"),app.containers.spinner.classList.remove("hidden");var l=new Headers;l.append("Authorization","Bearer "+localStorage.getItem("bearer")),l.append("Content-Type","application/json");var s={method:"GET",headers:l},o=app.baseUrl+"/"+app.api_version+"/rules/"+t;fetch(o,s).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(e){for(var i=0;i<e.data.length;i++){var l=e.data[i];document.title=app.sectionsPageTitles.rule.replace(/%s/g,l.attributes.name);var s,o=[app.getUniqueId(),app.getUniqueId(),app.getUniqueId()];a?(s='<section class="mdl-grid mdl-cell--12-col" data-id="'+l.id+'">',s+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',s+='		<div class="mdl-list__item">',s+="			<span class='mdl-list__item-primary-content'>",s+='				<i class="material-icons">'+app.icons.rules+"</i>",s+='				<h2 class="mdl-card__title-text">'+l.attributes.name+"</h2>",s+="			</span>",s+="			<span class='mdl-list__item-secondary-action'>",s+="				<button role='button' class='mdl-button mdl-js-button mdl-button--icon right showdescription_button' for='description-"+l.id+"'>",s+="					<i class='material-icons'>expand_more</i>",s+="				</button>",s+="			</span>",s+="		</div>",s+="		<div class='mdl-cell--12-col hidden' id='description-"+l.id+"'>",s+=app.getField(app.icons.rules,"Id",l.id,{type:"text"}),l.attributes.meta.created&&(s+=app.getField(app.icons.date,"Created",moment(l.attributes.meta.created).format(app.date_format),{type:"text"})),l.attributes.meta.updated&&(s+=app.getField(app.icons.date,"Updated",moment(l.attributes.meta.updated).format(app.date_format),{type:"text"})),l.attributes.meta.revision&&(l+=app.getField(app.icons.update,"Revision",l.attributes.meta.revision,{type:"text"})),s+="	</div>",s+="</section>",s+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+t+"'>",app.isLtr()&&(s+="	<div class='mdl-layout-spacer'></div>"),s+="	<div class='mdl-cell--1-col-phone pull-left'>",s+="		<button id='"+o[0]+"' class='back-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t+"'>",s+="			<i class='material-icons'>chevron_left</i>",s+="			<label>View</label>",s+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+o[0]+"'>View Rule</label>",s+="		</button>",s+="	</div>",s+="	<div class='mdl-cell--1-col-phone pull-right'>",s+="		<button id='"+o[1]+"' class='save-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t+"'>",s+="			<i class='material-icons'>save</i>",s+="			<label>Save</label>",s+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+o[1]+"'>Save changes to Rule</label>",s+="		</button>",s+="	</div>",app.isLtr()||(s+="	<div class='mdl-layout-spacer'></div>"),s+="</section>",app.containers.rule.querySelector(".page-content").innerHTML=s,componentHandler.upgradeDom(),app.setExpandAction(),app.refreshButtonsSelectors(),app.buttons.backRule.addEventListener("click",function(t){app.resources.rules.display(l.id,!1,!1,!1)},!1),app.buttons.saveRule.addEventListener("click",function(t){app.resources.rules.onEdit(t)},!1)):(s='<section class="mdl-grid mdl-cell--12-col" data-id="'+t+'">',s+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',s+='		<div class="mdl-list__item">',s+="			<span class='mdl-list__item-primary-content'>",s+='				<h2 class="mdl-card__title-text">',s+='					<i class="material-icons">'+app.icons.rules+"</i>",s+="					"+l.attributes.name+"</h2>",s+="			</span>",s+="			<span class='mdl-list__item-secondary-action'>",s+="				<button role='button' class='mdl-button mdl-js-button mdl-button--icon right showdescription_button' for='description-"+t+"'>",s+="					<i class='material-icons'>expand_more</i>",s+="				</button>",s+="			</span>",s+="		</div>",s+="		<div class='mdl-cell mdl-cell--12-col hidden' id='description-"+t+"'>",l.attributes.meta.created&&(s+=app.getField(app.icons.date,"Created",moment(l.attributes.meta.created).format(app.date_format),{type:"text"})),l.attributes.meta.updated&&(s+=app.getField(app.icons.date,"Updated",moment(l.attributes.meta.updated).format(app.date_format),{type:"text"})),l.attributes.meta.revision&&(s+=app.getField(app.icons.update,"Revision",l.attributes.meta.revision,{type:"text"})),s+="	</div>",s+="</section>",s+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+flow.id+"'>",app.isLtr()&&(s+="	<div class='mdl-layout-spacer'></div>"),s+="	<div class='mdl-cell--1-col-phone pull-left'>",s+="		<button id='"+o[0]+"' class='list-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+flow.id+"'>",s+="			<i class='material-icons'>chevron_left</i>",s+="			<label>List</label>",s+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+o[0]+"'>List all Rules</label>",s+="		</button>",s+="	</div>",s+="	<div class='mdl-cell--1-col-phone delete-button'>",s+="		<button id='"+o[1]+"' class='delete-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+flow.id+"'>",s+="			<i class='material-icons'>delete</i>",s+="			<label>Delete</label>",s+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+o[1]+"'>Delete Rule</label>",s+="		</button>",s+="	</div>",s+="	<div class='mdl-cell--1-col-phone pull-right'>",s+="		<button id='"+o[2]+"' class='edit-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+flow.id+"'>",s+="			<i class='material-icons'>edit</i>",s+="			<label>Edit</label>",s+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+o[2]+"'>Edit Rule</label>",s+="		</button>",s+="	</div>",app.isLtr()||(s+="	<div class='mdl-layout-spacer'></div>"),s+="</section>",app.containers.rule.querySelector(".page-content").innerHTML=s,componentHandler.upgradeDom(),app.setExpandAction(),app.refreshButtonsSelectors(),app.buttons.listRule.addEventListener("click",function(t){app.setSection("rules"),t.preventDefault()},!1),app.buttons.editRule2.addEventListener("click",function(t){app.resources.rules.display(l.id,!1,!0,!1),t.preventDefault()},!1)),app.setSection("rule")}})["catch"](function(t){"true"==localStorage.getItem("settings.debug")&&toast("displayRule error occured..."+t,{timeout:3e3,type:"error"})}),app.containers.spinner.setAttribute("hidden",!0)},displayPublic:function(t,e,a,i){},displayAdd:function(t,e,a,i){var l="";l='<section class="mdl-grid mdl-cell--12-col" data-id="'+t.id+'">',l+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',l+=app.getField(app.icons.rules,"Name",t.attributes.name,{type:"text",id:"Name",isEdit:!0,pattern:app.patterns.name,error:"Name should be set and more than 3 chars length."}),l+=app.getField("add_circle_outline","Event Type",t.attributes.event.type,{type:"select",id:"EventType",options:app.EventTypes,isEdit:!0}),l+=app.getField("swap_vert","Priority",t.attributes.priority,{type:"text",id:"Priority",isEdit:!0,pattern:app.patterns.integerNotNegative,error:"Should be a positive integer."}),l+=app.getField("traffic","false"!=t.attributes.active?"Rule is active":"Rule is disabled",void 0!==t.attributes.active?t.attributes.active:!0,{type:"switch",id:"active",isEdit:!0}),l+="	</div>",l+="</section>",l+=app.getSubtitle("Event Conditions"),l+='<section class="mdl-grid mdl-cell--12-col" data-id="'+t.id+'_parameters">',l+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',l+=app.getField(app.icons.description,"Event Conditions",app.nl2br(t.attributes.event.conditions),{type:"textarea",id:"EventConditions",isEdit:!0}),l+="	</div>",l+="</section>",l+=app.getSubtitle("Event Parameters"),l+='<section class="mdl-grid mdl-cell--12-col" data-id="'+t.id+'_parameters">',l+='	<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',l+=app.getField("note",["Name","Value"],["",""],{type:"2inputs",pattern:[app.patterns.customAttributeName,app.patterns.customAttributeValue],error:["Name should not contains any space nor special char.","Value is free."],id:["Name[]","Value[]"],isEdit:!0}),l+=app.getField(app.icons.description,"Event Parameters",app.nl2br(t.attributes.event.parameters),{type:"textarea",id:"EventParams",isEdit:!0}),l+="	</div>",l+="</section>";var s=[app.getUniqueId(),app.getUniqueId(),app.getUniqueId()];l+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+t.id+"'>",app.isLtr()&&(l+="	<div class='mdl-layout-spacer'></div>"),l+="	<div class='mdl-cell--1-col-phone pull-left'>",l+="		<button id='"+s[0]+"' class='back-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+object.id+"'>",l+="			<i class='material-icons'>chevron_left</i>",l+="			<label>List</label>",l+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+s[0]+"'>List all Rules</label>",l+="		</button>",l+="	</div>",l+="	<div class='mdl-cell--1-col-phone pull-right'>",l+="		<button id='"+s[1]+"' class='add-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+object.id+"'>",l+="			<i class='material-icons'>edit</i>",l+="			<label>Save</label>",l+="			<div class='mdl-tooltip mdl-tooltip--top' for='"+s[1]+"'>Save new Rule</label>",l+="		</button>",l+="	</div>",app.isLtr()||(l+="	<div class='mdl-layout-spacer'></div>"),l+="</section>",app.containers.rule_add.querySelector(".page-content").innerHTML=l,componentHandler.upgradeDom(),app.refreshButtonsSelectors(),document.getElementById("switch-active")&&document.getElementById("switch-active").addEventListener("change",function(t){var e=t.target.parentElement.querySelector("div.mdl-switch__label");1==document.getElementById("switch-active").checked?e.innerText="Rule is active":e.innerText="Rule is disabled"}),app.buttons.addRuleBack.addEventListener("click",function(t){app.setSection("rules"),t.preventDefault()},!1),app.buttons.addRule.addEventListener("click",function(t){app.resources.rules.onAdd(t)},!1),app.setExpandAction()},displayItem:function(t){}},app.resources.mqtts={onEdit:function(t){},onAdd:function(t){},onDelete:function(t){},display:function(t,e,a,i){},displayPublic:function(t,e,a,i){},displayAdd:function(t,e,a,i){},displayItem:function(t){}};var snippet={id:"valueDisplay.js",name:"Value Display",options:{color:{defaultVvalue:"#FF0000"},legend:{defaultVvalue:"top",availableValues:[!0,!1,"top","bottom"]}},getHtml:function(t){return"<div class='valuedisplay tile card-valuedisplay material-animate margin-top-4 material-animated mdl-shadow--2dp'>"+t.name+"</div>"}};app.snippetTypes.push(snippet);